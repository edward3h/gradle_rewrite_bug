plugins {
    id 'application'
    id("org.openrewrite.rewrite") version("5.28.0")
}

repositories {
    mavenCentral()
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
    }
}

application {
    mainClass = 'org.ethelred.test.Hello'
    applicationName = 'hello'
}

dependencies {

}


task install {
    dependsOn installDist
    doLast {
        ant.mkdir(dir: "${rootDir}/bin")
        ant.symlink(resource: "${(installDist.outputs.files as List).first()}/bin/${application.applicationName}", link: "${rootDir}/bin/${application.applicationName}")
    }
}

task cleanBin(type: Delete) {
    delete 'bin'
}

clean.dependsOn cleanBin

rewrite {
    activeRecipe("org.openrewrite.java.cleanup.Cleanup")
}